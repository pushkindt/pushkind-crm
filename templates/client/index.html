{% extends 'base.html' %}

{% block content %}
    {% include 'components/navigation.html' %}

<div class="container">
    <div class="row my-2">
        <div class="col">
            <span class="fw-bold">
                {{client.name}}
            </span>
        </div>
        <div class="col-auto">
            {% include 'client/actions.html' %}
        </div>
    </div>
    <div class="row">
        <div class="col-sm-5 my-1">
            <div class="row">
                <div class="col">
                    <span class="fw-bold">Электронный адрес:</span>
                    <a href="#clientModal" data-bs-toggle="modal">{{client.email}}</a>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <span class="fw-bold">Телефон:</span>
                    <a href="#clientModal" data-bs-toggle="modal">{{client.phone}}</a>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <span class="fw-bold">Адрес:</span>
                    <a href="#clientModal" data-bs-toggle="modal">{{client.address}}</a>
                </div>
            </div>
            {% if managers %}
                <div class="row">
                    <div class="col">
                        <span class="fw-bold">Менеджеры:</span>
                        {% for manager in managers %}
                            {% include 'components/user_popover.html' %}
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
            {% if documents %}
                <div class="row">
                    <div class="col">
                        <span class="fw-bold">Документы:</span>
                        <ul>
                            {% for document in documents %}
                                <li>
                                    <a class="text-warning" href="{{ document.event_data["url"] }}">
                                        {{ document.event_data["text"] }}
                                    </a>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% endif %}
        </div>
        <div class="col-sm my-1">
            <form action="/client/comment" method="POST">
                <input type="hidden" name="id" value="{{client.id}}" required readonly>
                <div class="row">
                    <div class="col">
                        <textarea rows="2" name="text" class="form-control my-1" value="" placeholder="Комментарий" required></textarea>
                    </div>
                    <div class="col-auto">
                        <div class="row">
                            <div class="col">
                                <select name="event_type" class="form-select form-select-sm" aria-label="Select event type" required>
                                    <option value="Comment">Комментарий</option>
                                    <option value="Call">Звонок</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                 <button class="btn btn-primary btn-sm my-1 w-100" type="submit">Сохранить</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <div id="events">
                {% for event_manager in events %}
                    {% set event = event_manager.0 %}
                    {% set manager = event_manager.1 %}
                    {% include 'components/client_event.html' %}
                {% endfor %}
            </div>
        </div>

    </div>


{% include 'client/save_client_modal.html' %}
{% include 'client/attachment_modal.html' %}

</div>


{% endblock %}
